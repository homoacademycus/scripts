FROM centos:7
MAINTAINER homoacademycus

ARG appuser
ARG appgroup
ARG workingdir

RUN yum install -y epel-release
RUN yum install -y git
RUN yum install -y python3

RUN groupadd ${appgroup}
RUN useradd --groups ${appgroup} --create-home ${appuser} 
RUN gpasswd --restrict ${appgroup}

RUN mkdir -p ${workingdir}
COPY packages/pip.django.list ${workingdir}/pip.django.list
RUN chown -R ${appuser}:${appgroup} ${workingdir}
RUN chmod -R 770 ${workingdir}
WORKDIR ${workingdir}

RUN passwd --lock root
USER ${appuser}

# Install to the Python user install directory (/home/${appuser}/.local)
RUN pip3 install --user --requirement ${workingdir}/pip.django.list

RUN export PATH=/home/${appuser}/.local/bin:$PATH
RUN source /home/${appuser}/.bash_profile

ENTRYPOINT "/bin/bash"
